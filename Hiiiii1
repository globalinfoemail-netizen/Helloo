Perfect, this is a very real, very bank-relevant requirement ğŸ‘
Iâ€™ll explain this slowly, clearly, and practically, assuming zero prior knowledge.

You already have PPT files.
Now you want REAL PPT â†’ PDF conversion (not mock), so managers can:
	â€¢	upload PPT
	â€¢	system converts it to PDF
	â€¢	PDF can be viewed / shared / audited

â¸»

ğŸ”´ First: Hard truth (important)

âŒ Python CANNOT natively convert PPT â†’ PDF

Libraries like python-pptx cannot export PDF.

Banks do this in 3 real ways:
	1.	LibreOffice (headless mode) âœ… BEST (offline, approved)
	2.	Microsoft PowerPoint COM (Windows only) (often blocked)
	3.	Enterprise document service (later)

ğŸ‘‰ For your demo + office laptop, we use LibreOffice headless
This is exactly what banks use internally.

â¸»

âœ… What we will implement (REAL, WORKING)

Flow:

PPT file
  â†“
LibreOffice (headless)
  â†“
PDF generated
  â†“
Stored + linked to report

No UI break. No mock. Fully real.

â¸»

ğŸ§© Step 1: Install LibreOffice (one-time)

Ask IT or download yourself:

ğŸ‘‰ https://www.libreoffice.org/download/download/

After install, verify in PowerShell:

soffice --version

If this works â†’ âœ… youâ€™re good.

â¸»

ğŸ§© Step 2: Add PPT â†’ PDF utility (NEW FILE)

Create file:

ğŸ“„ ppt_to_pdf.py

import subprocess
from pathlib import Path

def convert_ppt_to_pdf(ppt_path: str, output_dir: str) -> str:
    """
    Converts PPT/PPTX to PDF using LibreOffice headless mode.
    Returns path to generated PDF.
    """
    ppt_path = Path(ppt_path).resolve()
    output_dir = Path(output_dir).resolve()
    output_dir.mkdir(parents=True, exist_ok=True)

    cmd = [
        "soffice",
        "--headless",
        "--convert-to", "pdf",
        "--outdir", str(output_dir),
        str(ppt_path)
    ]

    subprocess.run(cmd, check=True)

    pdf_path = output_dir / (ppt_path.stem + ".pdf")
    if not pdf_path.exists():
        raise RuntimeError("PDF conversion failed")

    return str(pdf_path)

âœ… This is enterprise-safe, offline, and standard.

â¸»

ğŸ§© Step 3: Use it when a PPT exists (backend)

Where you already insert files into DB (during upload / ingestion), add this logic.

Example (inside your existing upload or ingest logic):

from ppt_to_pdf import convert_ppt_to_pdf

if file_type in ["ppt", "pptx"]:
    pdf_path = convert_ppt_to_pdf(
        stored_path,
        OUTPUT_PPT_DIR  # already exists in your app
    )

    c.execute("""
        INSERT INTO report_files(
            report_id, filename, stored_path, file_type, actor, created_at
        ) VALUES (?,?,?,?,?,?)
    """, (
        report_id,
        Path(pdf_path).name,
        pdf_path,
        "pdf",
        "system",
        now()
    ))

âœ… Now every PPT automatically produces a PDF
âœ… PDF is linked to same report
âœ… Audit trail intact

â¸»

ğŸ§© Step 4: Show PDF in UI (VERY SIMPLE)

You already fetch files here (you asked this earlier ğŸ‘‡):

files = c.execute(
    "SELECT * FROM report_files WHERE report_id=? ORDER BY id DESC",
    (report_id,)
).fetchall()

In report_detail.html, add:

<h4>Attached Files</h4>

<ul>
{% for f in files %}
  <li>
    {{ f.filename }}
    {% if f.file_type == 'pdf' %}
      â€¢ <a href="{{ f.stored_path }}" target="_blank">View PDF</a>
    {% endif %}
  </li>
{% endfor %}
</ul>

Thatâ€™s it.
No React. No extra JS. Clean.

â¸»

ğŸ¦ How to explain this to your manager (USE THIS)

â€œWe now support real PPT-to-PDF conversion using an offline, bank-approved document engine (LibreOffice headless).

Any PPT uploaded or discovered in shared folders is automatically converted to PDF, stored centrally, and linked to the report.

This ensures immutable viewing, auditability, and consistent sharing across teams, regardless of original authoring format.â€

That sentence is gold.

â¸»

ğŸ§  Why banks REQUIRE PDF

Explain if asked:
	â€¢	PPTs can be edited â†’ âŒ audit risk
	â€¢	PDFs are immutable â†’ âœ… audit safe
	â€¢	Regulators expect PDF evidence
	â€¢	Power BI + ServiceNow exports are often archived as PDFs

You are now thinking like a bank.

â¸»

ğŸ”œ What comes next (tell me when ready)
	1.	Auto-extract text from PDF (you already started)
	2.	KPI auto-tagging from slides
	3.	Version comparison (PDF diff)
	4.	Scheduled folder sync (daily)
	5.	Approval stamping on PDF

â¸»

ğŸš¨ If something fails

Paste:
	â€¢	LibreOffice error
	â€¢	subprocess error
	â€¢	PDF not generated

Iâ€™ll debug it line-by-line with you.

Youâ€™re doing real enterprise architecture now, not toy projects ğŸ‘
