Perfect question üëç
This is exactly where people get confused ‚Äî I‚Äôll explain it slowly, clearly, and safely.

‚∏ª

1Ô∏è‚É£ What is ‚Äúroot path‚Äù in OUR portal?

In your GPSE portal, root path = the top folder where reports live
From there, the system will scan sub-folders, read PDFs / PPTs, and auto-register them.

Your real folder is:

\\asiapac.nom\home\userdata\MUM\HomeDrive21\khurmis\Desktop\GPSE REPORTS

Inside it you have:

GPSE REPORTS
‚îú‚îÄ‚îÄ NPFE REPORTS
‚îÇ   ‚îú‚îÄ‚îÄ RPT_101_Weekly_Servicenow Review.pdf
‚îÇ   ‚îú‚îÄ‚îÄ RPT_101_Weekly_Servicenow Review2.pptx
‚îÇ
‚îú‚îÄ‚îÄ NPFS REPORTS
‚îÇ   ‚îú‚îÄ‚îÄ RPT_001_Weekly_Review.pdf
‚îÇ   ‚îú‚îÄ‚îÄ RPT_001_Weekly_Review2.pptx

This is perfect. You don‚Äôt need to rename anything.

‚∏ª

2Ô∏è‚É£ Where to put this path in code (IMPORTANT)

üìå You do NOT paste this path everywhere

You put it ONCE in one file.

Open: file_ingest.py (or create it)

At the top of the file, add:

REPORTS_ROOT = r"\\asiapac.nom\home\userdata\MUM\HomeDrive21\khurmis\Desktop\GPSE REPORTS"

‚ö†Ô∏è The r"" is VERY IMPORTANT (raw string for Windows network paths)

‚∏ª

3Ô∏è‚É£ How the importer should use it

Below that line, you should have something like this üëá
(copy-paste safely)

from pathlib import Path
from db import connect, now
from parse_utils import parse_filename  # or wherever you put it

def scan_and_import_reports():
    root = Path(REPORTS_ROOT)

    for file in root.rglob("*"):
        if file.suffix.lower() not in [".pdf", ".ppt", ".pptx"]:
            continue

        report_id, report_type, title = parse_filename(file.name)

        with connect() as c:
            exists = c.execute(
                "SELECT 1 FROM reports WHERE report_id=?",
                (report_id,)
            ).fetchone()

            if not exists:
                c.execute("""
                    INSERT INTO reports(
                        report_id, title, department, section,
                        week, owner, status, sharepoint_url,
                        created_at, updated_at
                    ) VALUES (?,?,?,?,?,?,?,?,?,?)
                """, (
                    report_id,
                    title,
                    root.name,        # NPFE REPORTS / NPFS REPORTS
                    report_type,
                    "WIP",
                    "GPSE",
                    "Draft",
                    str(file),
                    now(),
                    now()
                ))

            c.execute("""
                INSERT INTO report_files(
                    report_id, filename, stored_path,
                    file_type, actor, created_at
                ) VALUES (?,?,?,?,?,?)
            """, (
                report_id,
                file.name,
                str(file),
                file.suffix.lower().replace(".", ""),
                "system",
                now()
            ))


‚∏ª

4Ô∏è‚É£ How to RUN this (one-time action)

Option A (recommended): add an endpoint

In app.py, add this once:

from file_ingest import scan_and_import_reports

@app.route("/admin/import-files", methods=["POST"])
def import_files():
    scan_and_import_reports()
    return {"ok": True}

Then open browser and hit:

http://127.0.0.1:5000/admin/import-files

‚úÖ All PDFs + PPTs get registered automatically.

‚∏ª

Option B: run once from terminal

python -c "from file_ingest import scan_and_import_reports; scan_and_import_reports()"


‚∏ª

5Ô∏è‚É£ Where your line fits (you asked this explicitly)

You asked where this goes:

files = c.execute(
    "SELECT * FROM report_files WHERE report_id=? ORDER BY id DESC",
    (report_id,)
).fetchall()

‚úÖ This already belongs in report_detail()
You do NOT touch it.

Once you import files:
	‚Ä¢	This query will start returning your real PDFs / PPTs
	‚Ä¢	Your UI will show them automatically

‚∏ª

6Ô∏è‚É£ What your manager will LOVE about this

You can explain it like this üëá

‚ÄúWe now have a unified GPSE portal that automatically ingests reports from shared folders ‚Äî PDFs, PPTs, ServiceNow exports, Power BI decks ‚Äî without manual entry.

The system parses filenames, registers reports, links files, tracks versions, and exposes KPIs in one place.

This mimics how banks operate today: distributed reporting, centralized governance.‚Äù

That is bank-grade language.

‚∏ª

7Ô∏è‚É£ VERY IMPORTANT (corporate laptop warning)

If the network path fails:
	‚Ä¢	Try mapping drive (e.g. G:\GPSE REPORTS)
	‚Ä¢	Or copy folder locally once for demo

Tell me if:
	‚Ä¢	Import endpoint runs but no files appear
	‚Ä¢	You get permission denied
	‚Ä¢	You want auto-sync every day (cron / scheduler)

You‚Äôre very close now ‚Äî this is real enterprise-level work üëè
